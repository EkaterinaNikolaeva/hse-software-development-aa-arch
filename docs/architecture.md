# Структура проекта и основные компоненты

## 1. Структура проекта

```cpp
/rsq_library              # Модуль с алгоритмами RSQ (header-only)
  /include                # Заголовочные файлы с реализациями алгоритмов
  /tests                  # Unit-тесты для проверки алгоритмов

/experiment_environment   # Модуль экспериментальной среды
  /include                # Заголовочные файлы для экспериментальной среды
  /src                    # Исходный код для экспериментальной среды
  /data                   # Пример входных данных для тестирования
  /results                # Результаты тестов и сравнений

/docs                     # Документация
```

### Краткое описание классов проекта

![Диаграмма структуры проекта](img/diag.png)

#### 1. Модуль с алгоритмами RSQ

Этот модуль предоставляет **header-only библиотеку**, содержащую реализации структур данных для операций суммирования на отрезке (RSQ).

- **Класс `IRSQ`**: Базовый интерфейс для всех алгоритмов RSQ. Определяет стандартные методы `Query` и `Update`.
- **Реализации классов**: Каждая структура данных (например, FenwickTree, SegmentTree, PrefixSum) реализует интерфейс `IRSQ` и предоставляет свою версию методов.
- **Класс `ITestRSQ`**: Обеспечивает юнит-тестирование реализаций. Включает тесты на корректность выполнения операций `Query` и `Update`.

#### 2. Модуль экспериментальной среды

Этот модуль отвечает за проведение и управление экспериментами, измерение производительности и визуализацию результатов.

##### 1. Конфигурация экспериментов

- **Структура `Config`**: Содержит параметры конфигурации для экспериментов: выбор алгоритмов, размеры данных и количество запросов.

##### 2. Менеджер экспериментов

- **Класс `ExperimentManager`**: Основной класс для управления экспериментами. Реализует:
  - Настройку конфигурации экспериментов.
  - Генерацию входных данных (случайных или пользовательских).
  - Проведение тестов и бенчмаркинга.
  - Сохранение и отображение результатов.

##### 3. Модуль визуализации

- **Класс `Visualizer`**: Реализует построение графиков производительности.
  - Метод `createBarChart` строит гистограммы для сравнения метрик (например, времени работы алгоритмов).
  - Метод `createLineChart` строит линейные графики, отображающие зависимость производительности от размера данных.

## 2.Основные компоненты проекта

### 1. Алгоритмы RSQ (header-only библиотека)

Реализует 8 структур данных для RSQ. Каждый алгоритм представлен отдельным классом, реализующим базовый интерфейс для унификации работы. Также в этом модуле находятся юнит-тесты для проверки правильности работы алгоритмов.

* Базовый интерфейс

```cpp
struct IRSQ {
  virtual int Query(std::size_t left, std::size_t right) = 0;
  virtual void Update(std::size_t index, int new_value) = 0;
  virtual ~IRSQ() = default;
};
```

* Юнит-тесты

```cpp
class ITestRSQ {
public:
  void TestQuery() {
    // тестирование метода Query
  }
  void TestUpdate() {
    // тестирование метода Update
  }
};
```

### 2. Экспериментальная среда

#### 1. Конфигурация экспериментов

Конфигурация задаётся прямо в коде для упрощения, без внешних файлов. Пример:

```cpp
struct Config {
    std::vector<RSQAlgorithm> algorithms = {RSQAlgorithm::PrefixSum, RSQAlgorithm::SegmentTree, RSQAlgorithm::FenwickTree};
    std::vector<int> dataSizes = {100, 1000, 10000};
    int queryCount = 100;
};
```

#### 2. Менеджер экспериментов

Основной компонент, который управляет всеми этапами эксперимента. Он будет:

* Генерировать данные в зависимости от конфигурации.
* Проводить измерение времени работы и количества памяти через Benchmark.
* Выводить результаты на экран и в файл.

Примерная структура класса, детали могут меняться

```cpp
class ExperimentManager {
public:
    // Установка конфигурации для экспериментов
    void setConfig(const Config& config);

    // Добавление алгоритма для тестирования
    void addAlgorithm(RSQAlgorithm algorithm);

    // Генерация данных (случайные, монотонные и т.д.)
    void generateData(size_t dataSize, const std::string& dataType);

    // Добавление пользовательских данных для тестирования
    void setCustomData(const std::vector<int>& data); 
    void setCustomDataFromFile(const std::string& filePath); 

    // Запуск экспериментов
    void runExperiments();

    // Получение результатов
    std::vector<std::string> getResults() const;

    // Визуализация результатов
    void visualizeResults(const std::string& outputPath, const std::string& graphType = "bar");
};
```

#### 4. Модуль визуализации

Визуализация реализуется в отдельном классе, который включён в менеджер. Примерная структура класса, детали могут меняться

```cpp
class Visualizer {
public:
    // Построение гистограммы
    void createBarChart(const std::unordered_map<RSQAlgorithm, double>& performanceMetrics, 
                        const std::string& outputPath);

    // Построение линейного графика
    void createLineChart(const std::unordered_map<RSQAlgorithm, std::vector<double>>& performanceMetricsBySize, 
                         const std::string& outputPath);
};
```
